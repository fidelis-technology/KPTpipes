<odoo>
   <record id="view_product_issue_form" model="ir.ui.view">
       <field name="name">product.issue.form</field>
       <field name="model">product.issue</field>
       <field name="arch" type="xml">
           <form string="Product Issue">
               <header>
                   <button name="action_confirm"
                           string="Confirm"
                           class="oe_highlight"
                           type="object"
                           invisible="state != 'draft'"/>
                   <button name="action_done"
                           string="Done"
                           type="object"
                           class="oe_highlight"
                           invisible="state != 'confirmed'"/>
                   <button name="action_cancel"
                           string="Cancel"
                           type="object"
                           invisible="state != 'draft'"/>
                   <button name="action_draft"
                           string="Set to Draft"
                           type="object"
                           invisible="state != 'cancelled'"/>
                   <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done"/>
               </header>
               <sheet>
                   <div class="oe_title">
                       <h1>
                           <field name="name" readonly="1"/>
                       </h1>
                   </div>
                   <group>
                       <group string="Basic Information">
                           <field name="issue_date"/>
                           <field name="vehicle_id"/>
                           <field name="warehouse_id"/>
                           <field name="company_id" groups="base.group_multi_company"/>
                           <field name="currency_id" invisible="1"/>
                           <field name="warehouse_id"/>
                           <field name="location_dest_id"/>
                       </group>
                       <group string="Vehicle Details">
                           <field name="number_plate"/>
                           <field name="chassis_number"/>
                           <field name="driver_id"/>
                       </group>
                   </group>
                   <group>
                       <group string="Responsible Persons">
                           <field name="issued_by" domain="[('department_id', '!=', False)]"/>
                           <field name="store_keeper" domain="[('department_id', '!=', False)]"/>
                           <field name="receiver_id" domain="[('department_id.name', 'ilike', 'driver')]"/>
                       </group>
                       <group string="Additional Information">
                           <field name="remarks" placeholder="Add any remarks here..."/>
                       </group>
                   </group>
                   <notebook>
                       <page string="Product Lines">
                           <field name="product_line_ids" invisible="state != 'draft'">
                               <tree editable="bottom">
                                   <field name="product_id"/>
                                   <field name="available_qty" readonly="1"/>
                                   <field name="quantity"/>
                                   <field name="standard_price" readonly="1"/>
                                   <field name="tax_ids" widget="many2many_tags" readonly="1"/>
                                   <field name="subtotal" readonly="1"/>
                                   <field name="tax_amount" readonly="1"/>
                                   <field name="total" readonly="1" sum="Total"/>
                                   <field name="currency_id" invisible="1"/>
                               </tree>
                           </field>
                           <field name="product_line_ids" readonly="1" invisible="state == 'draft'">
                               <tree>
                                   <field name="product_id"/>
                                   <field name="available_qty"/>
                                   <field name="quantity"/>
                                   <field name="standard_price"/>
                                   <field name="tax_ids" widget="many2many_tags"/>
                                   <field name="subtotal"/>
                                   <field name="tax_amount"/>
                                   <field name="total" sum="Total"/>
                               </tree>
                           </field>
                           <group class="oe_subtotal_footer">
                               <field name="total_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                               <field name="total_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                               <field name="total_amount" widget="monetary" options="{'currency_field': 'currency_id'}" class="oe_subtotal_footer_separator"/>
                           </group>
                       </page>
                       <page string="Documents">
                           <field name="document_ids">
                               <tree>
                                   <field name="name"/>
                                   <field name="create_date"/>
                               </tree>
                           </field>
                       </page>
                   </notebook>
               </sheet>
               <div class="oe_chatter">
                   <field name="message_follower_ids"/>
                   <field name="activity_ids"/>
                   <field name="message_ids"/>
               </div>
           </form>
       </field>
   </record>

   <record id="view_product_issue_tree" model="ir.ui.view">
       <field name="name">product.issue.tree</field>
       <field name="model">product.issue</field>
       <field name="arch" type="xml">
           <tree decoration-info="state == 'draft'" decoration-success="state == 'done'" decoration-warning="state == 'confirmed'">
               <field name="name"/>
               <field name="issue_date"/>
               <field name="vehicle_id"/>
               <field name="total_amount" sum="Total"/>
               <field name="state"/>
           </tree>
       </field>
   </record>

   <record id="view_product_issue_search" model="ir.ui.view">
       <field name="name">product.issue.search</field>
       <field name="model">product.issue</field>
       <field name="arch" type="xml">
           <search>
               <field name="name"/>
               <field name="vehicle_id"/>
               <field name="driver_id"/>
               <separator/>
               <filter string="Draft" name="draft" domain="[('state','=','draft')]"/>
               <filter string="Confirmed" name="confirmed" domain="[('state','=','confirmed')]"/>
               <filter string="Done" name="done" domain="[('state','=','done')]"/>
               <group expand="0" string="Group By">
                   <filter string="Status" name="state" context="{'group_by':'state'}"/>
                   <filter string="Vehicle" name="vehicle" context="{'group_by':'vehicle_id'}"/>
               </group>
           </search>
       </field>
   </record>

   <record id="action_product_issue" model="ir.actions.act_window">
       <field name="name">Product Issues</field>
       <field name="res_model">product.issue</field>
       <field name="view_mode">tree,form</field>
       <field name="search_view_id" ref="view_product_issue_search"/>
       <field name="help" type="html">
           <p class="o_view_nocontent_smiling_face">
               Create your first product issue
           </p>
       </field>
   </record>
</odoo>


